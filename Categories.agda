{-# OPTIONS --type-in-type #-}
module Rosetta.Categories where
open import Rosetta.CartesianClosed
open import Rosetta.Category
open import Rosetta.DiagramChasing
open import Rosetta.Equality
open import Rosetta.Equivalence
open import Rosetta.Functor
open import Rosetta.Functors
open import Rosetta.NaturalTransformation
open import Rosetta.Prelude
open import Rosetta.Sets

instance
  ğ“’ğ“ªğ“½âˆ£op : Op Functor
  ğ“’ğ“ªğ“½âˆ£op =
    let id : âˆ€ {ğ“’} â†’ ğ“’ âŸ¶ ğ“’
        id = record
          { _â‚€_      = id
          ; _â‚_      = id
          ; _â‚-cong_ = id
          ; resp-âˆ˜â‚€  = refl
          ; resp-âˆ˜â‚‚  = refl
          }

        _âˆ˜_ : âˆ€ {ğ“’ ğ““ ğ“”} â†’ ğ““ âŸ¶ ğ“” â†’ ğ“’ âŸ¶ ğ““ â†’ ğ“’ âŸ¶ ğ“”
        _âˆ˜_ {ğ“’} {ğ““} {ğ“”} ğ“– ğ“• =
          let open CategoryReasoning ğ“”
          in record
          { _â‚€_      = ğ“– â‚€_ âˆ˜ ğ“• â‚€_
          ; _â‚_      = ğ“– â‚_ âˆ˜ ğ“• â‚_
          ; _â‚-cong_ = ğ“– â‚-cong_ âˆ˜ ğ“• â‚-cong_
          ; resp-âˆ˜â‚€  = Î» {A} â†’ begin
            ğ“– â‚ ğ“• â‚ idâ‚ A â‚  â†“âŸ¨ ğ“– â‚-cong (resp-âˆ˜â‚€ ğ“•) âŸ©
            ğ“– â‚ idâ‚ ğ“• â‚€ A â‚  â†“âŸ¨ resp-âˆ˜â‚€ ğ“– âŸ©
            idâ‚ ğ“– â‚€ ğ“• â‚€ A â‚  âˆ
          ; resp-âˆ˜â‚‚  = Î» {A B C}
                         {f : ğ“’ âˆ£ A âŸ¶ B}
                         {g : ğ“’ âˆ£ B âŸ¶ C} â†’ begin
            ğ“– â‚ ğ“• â‚ (g âˆ˜ f)        â†“âŸ¨ ğ“– â‚-cong (resp-âˆ˜â‚‚ ğ“•) âŸ©
            ğ“– â‚ (ğ“• â‚ g âˆ˜ ğ“• â‚ f)    â†“âŸ¨ resp-âˆ˜â‚‚ ğ“– âŸ©
            ğ“– â‚ ğ“• â‚ g âˆ˜ ğ“– â‚ ğ“• â‚ f  âˆ
          }
    in record
    { id  = id
    ; _âˆ˜_ = _âˆ˜_
    }

module _ {ğ“’ ğ““} where
  infix 4 ğ“’ğ“ªğ“½âˆ£_âˆ¼_
  record ğ“’ğ“ªğ“½âˆ£_âˆ¼_ (ğ“• ğ“– : ğ“’ âŸ¶ ğ““) : Set where
    constructor _,_
    field
      ğ“•â‚€â‰¡ğ“–â‚€ : ğ“• â‚€_ â‰¡ ğ“– â‚€_
      ğ“•â‚âˆ¼ğ“–â‚ : âˆ€ {A B} {f g : ğ“’ âˆ£ A âŸ¶ B}
        â†’ ğ“’ âˆ£ f âˆ¼ g
        â†’ ğ““ âˆ£ transport (Î» ğ“•â‚€ â†’ ğ““ âˆ£ ğ“•â‚€ A âŸ¶ ğ“•â‚€ B) ğ“•â‚€â‰¡ğ“–â‚€ (ğ“• â‚ f) âˆ¼ ğ“– â‚ g

  .ğ“’ğ“ªğ“½âˆ£âˆ¼-refl  : âˆ€ {ğ“•} â†’ ğ“’ğ“ªğ“½âˆ£ ğ“• âˆ¼ ğ“•
  .ğ“’ğ“ªğ“½âˆ£âˆ¼-sym   : âˆ€ {ğ“• ğ“–} â†’ ğ“’ğ“ªğ“½âˆ£ ğ“• âˆ¼ ğ“– â†’ ğ“’ğ“ªğ“½âˆ£ ğ“– âˆ¼ ğ“•
  .ğ“’ğ“ªğ“½âˆ£âˆ¼-trans : âˆ€ {ğ“• ğ“– ğ“—} â†’ ğ“’ğ“ªğ“½âˆ£ ğ“• âˆ¼ ğ“– â†’ ğ“’ğ“ªğ“½âˆ£ ğ“– âˆ¼ ğ“— â†’ ğ“’ğ“ªğ“½âˆ£ ğ“• âˆ¼ ğ“—
  ğ“’ğ“ªğ“½âˆ£âˆ¼-refl  {ğ“•}                               = â‰¡-refl , Î» fâˆ¼g â†’ ğ“• â‚-cong fâˆ¼g
  ğ“’ğ“ªğ“½âˆ£âˆ¼-sym   (â‰¡-refl , ğ“•â‚âˆ¼ğ“–â‚)                  = â‰¡-refl , Î» fâˆ¼g â†’ sym (ğ“•â‚âˆ¼ğ“–â‚ (sym fâˆ¼g))
  ğ“’ğ“ªğ“½âˆ£âˆ¼-trans (â‰¡-refl , ğ“•â‚âˆ¼ğ“–â‚) (â‰¡-refl , ğ“–â‚âˆ¼ğ“—â‚) = â‰¡-refl , Î» fâˆ¼g â†’ trans (ğ“•â‚âˆ¼ğ“–â‚ fâˆ¼g) (ğ“–â‚âˆ¼ğ“—â‚ refl)

  instance
    ğ“’ğ“ªğ“½âˆ£âˆ¼-equiv : IsEquivalence ğ“’ğ“ªğ“½âˆ£_âˆ¼_
    ğ“’ğ“ªğ“½âˆ£âˆ¼-equiv = record
      { refl  = ğ“’ğ“ªğ“½âˆ£âˆ¼-refl
      ; sym   = ğ“’ğ“ªğ“½âˆ£âˆ¼-sym
      ; trans = ğ“’ğ“ªğ“½âˆ£âˆ¼-trans
      }

ğ“’ğ“ªğ“½ : Category
ğ“’ğ“ªğ“½ = record
  { ob = Category
  ; _âˆ£_âŸ¶_ = Functor
  ; _âˆ£_âˆ¼_ = ğ“’ğ“ªğ“½âˆ£_âˆ¼_
  ; âˆ˜-congâ‚‚ = Î» { (â‰¡-refl , ğ“–â‚âˆ¼ğ“–â€²â‚) (â‰¡-refl , ğ“•â‚âˆ¼ğ“•â€²â‚) â†’ â‰¡-refl , Î» fâˆ¼fâ€² â†’ ğ“–â‚âˆ¼ğ“–â€²â‚ (ğ“•â‚âˆ¼ğ“•â€²â‚ fâˆ¼fâ€²) }
  ; âˆ˜-unitË¡ = refl
  ; âˆ˜-unitÊ³ = refl
  ; âˆ˜-assoc = refl
  }

{-# DISPLAY ğ“’ğ“ªğ“½âˆ£_âˆ¼_ ğ“• ğ“– = ğ“’ğ“ªğ“½ âˆ£ ğ“• âˆ¼ ğ“– #-}

module ğ“’ğ“ªğ“½ where
  infixr 6 _Ã—_
  infixr 7 _â‡’_

  ğŸ™ : Category
  ğŸ™ = record
    { ob = ğ“¢et.ğŸ™
    ; _âˆ£_âŸ¶_ = Î» _ _ â†’ ğ“¢et.ğŸ™
    ; _âˆ£_âˆ¼_ = Î» _ _ â†’ ğ“¢et.ğŸ™
    ; op = record
      { id  =         tt
      ; _âˆ˜_ = Î» _ _ â†’ tt
      }
    ; âˆ¼-equiv = record
      { refl  =         tt
      ; sym   = Î» _   â†’ tt
      ; trans = Î» _ _ â†’ tt
      }
    ; âˆ˜-congâ‚‚ = Î» _ _ â†’ tt
    ; âˆ˜-unitË¡ =         tt
    ; âˆ˜-unitÊ³ =         tt
    ; âˆ˜-assoc =         tt
    }

  _Ã—_ : Category â†’ Category â†’ Category
  ğ“’ Ã— ğ““ = record
    { ob = ob ğ“’ ğ“¢et.Ã— ob ğ““
    ; _âˆ£_âŸ¶_ = Î» { (Aâ‚ , Aâ‚‚) (Bâ‚ , Bâ‚‚) â†’ (ğ“’ âˆ£ Aâ‚ âŸ¶ Bâ‚) ğ“¢et.Ã— (ğ““ âˆ£ Aâ‚‚ âŸ¶ Bâ‚‚) }
    ; _âˆ£_âˆ¼_ = Î» { (fâ‚ , fâ‚‚) (gâ‚ , gâ‚‚) â†’ (ğ“’ âˆ£ fâ‚ âˆ¼ gâ‚) ğ“¢et.Ã— (ğ““ âˆ£ fâ‚‚ âˆ¼ gâ‚‚) }
    ; op = record
      { id  = id , id
      ; _âˆ˜_ = Î» { (gâ‚ , gâ‚‚) (fâ‚ , fâ‚‚) â†’ gâ‚ âˆ˜ fâ‚ , gâ‚‚ âˆ˜ fâ‚‚ }
      }
    ; âˆ¼-equiv = record
      { refl  = refl , refl
      ; sym   = Î» { (fâ‚âˆ¼gâ‚ , fâ‚‚âˆ¼gâ‚‚) â†’ sym fâ‚âˆ¼gâ‚ , sym fâ‚‚âˆ¼gâ‚‚ }
      ; trans = Î» { (fâ‚âˆ¼gâ‚ , fâ‚‚âˆ¼gâ‚‚) (gâ‚âˆ¼hâ‚ , gâ‚‚âˆ¼hâ‚‚) â†’ trans fâ‚âˆ¼gâ‚ gâ‚âˆ¼hâ‚ , trans fâ‚‚âˆ¼gâ‚‚ gâ‚‚âˆ¼hâ‚‚ }
      }
    ; âˆ˜-congâ‚‚ = Î» { (gâ‚âˆ¼gâ‚‚ , gâ‚â€²âˆ¼gâ‚‚â€²) (fâ‚âˆ¼fâ‚‚ , fâ‚â€²âˆ¼fâ‚‚â€²) â†’ âˆ˜-congâ‚‚ ğ“’ gâ‚âˆ¼gâ‚‚ fâ‚âˆ¼fâ‚‚ , âˆ˜-congâ‚‚ ğ““ gâ‚â€²âˆ¼gâ‚‚â€² fâ‚â€²âˆ¼fâ‚‚â€² }
    ; âˆ˜-unitË¡ = âˆ˜-unitË¡ ğ“’ , âˆ˜-unitË¡ ğ““
    ; âˆ˜-unitÊ³ = âˆ˜-unitÊ³ ğ“’ , âˆ˜-unitÊ³ ğ““
    ; âˆ˜-assoc = âˆ˜-assoc ğ“’ , âˆ˜-assoc ğ““
    }

  _â‡’_ : Category â†’ Category â†’ Category
  _â‡’_ = [_,_]

open ğ“’ğ“ªğ“½

instance
  ğ“’ğ“ªğ“½âˆ£opâœ“ : Opâœ“ Functor
  ğ“’ğ“ªğ“½âˆ£opâœ“ =
    let ! : âˆ€ {ğ“§} â†’ ğ“§ âŸ¶ ğŸ™
        ! = record
          { _â‚€_      = !
          ; _â‚_      = !
          ; _â‚-cong_ = !
          ; resp-âˆ˜â‚€  = tt
          ; resp-âˆ˜â‚‚  = tt
          }

        Ï€â‚ : âˆ€ {ğ“’ ğ““} â†’ ğ“’ Ã— ğ““ âŸ¶ ğ“’
        Ï€â‚ = record
          { _â‚€_      = Ï€â‚
          ; _â‚_      = Ï€â‚
          ; _â‚-cong_ = Ï€â‚
          ; resp-âˆ˜â‚€  = refl
          ; resp-âˆ˜â‚‚  = refl
          }

        Ï€â‚‚ : âˆ€ {ğ“’ ğ““} â†’ ğ“’ Ã— ğ““ âŸ¶ ğ““
        Ï€â‚‚ = record
          { _â‚€_      = Ï€â‚‚
          ; _â‚_      = Ï€â‚‚
          ; _â‚-cong_ = Ï€â‚‚
          ; resp-âˆ˜â‚€  = refl
          ; resp-âˆ˜â‚‚  = refl
          }

        âŸ¨_,_âŸ© : âˆ€ {ğ“’ ğ““ ğ“§} â†’ ğ“§ âŸ¶ ğ“’ â†’ ğ“§ âŸ¶ ğ““ â†’ ğ“§ âŸ¶ ğ“’ Ã— ğ““
        âŸ¨ ğ“• , ğ“– âŸ© = record
          { _â‚€_      = âŸ¨ ğ“• â‚€_ , ğ“– â‚€_ âŸ©
          ; _â‚_      = âŸ¨ ğ“• â‚_ , ğ“– â‚_ âŸ©
          ; _â‚-cong_ = âŸ¨ ğ“• â‚-cong_ , ğ“– â‚-cong_ âŸ©
          ; resp-âˆ˜â‚€  = resp-âˆ˜â‚€ ğ“• , resp-âˆ˜â‚€ ğ“–
          ; resp-âˆ˜â‚‚  = resp-âˆ˜â‚‚ ğ“• , resp-âˆ˜â‚‚ ğ“–
          }

        Îµ : âˆ€ {ğ“’ ğ““} â†’ [ ğ“’ , ğ““ ] Ã— ğ“’ âŸ¶ ğ““
        Îµ {_} {ğ““} =
          let open CategoryReasoning ğ““
          in record
          { _â‚€_      = Î» { (ğ“• , A) â†’ ğ“• â‚€ A }
          ; _â‚_      = Î» { {ğ“• , A} {ğ“– , B} (Î± , f) â†’ Î± â‚ B â‚ âˆ˜ ğ“• â‚ f }
          ; _â‚-cong_ = Î» { {ğ“• , A} {ğ“– , B} {Î± , f} {Î±â€² , fâ€²} (Î±âˆ¼Î±â€² , fâˆ¼fâ€²) â†’ âˆ˜-congâ‚‚ ğ““ Î±âˆ¼Î±â€² (ğ“• â‚-cong fâˆ¼fâ€²) }
          ; resp-âˆ˜â‚€  = Î» { {ğ“• , A} â†’ begin
            id âˆ˜ ğ“• â‚ id  â†“âŸ¨ âˆ˜-unitË¡ ğ““ âŸ©
            ğ“• â‚ id       â†“âŸ¨ resp-âˆ˜â‚€ ğ“• âŸ©
            id           âˆ }
          ; resp-âˆ˜â‚‚  = Î» { {ğ“• , A} {ğ“– , B} {ğ“— , C}
                           {Î± , f} -- Î± : ğ“ğ“ªğ“½ âˆ£ ğ“• âŸ¶ ğ“–
                                   -- f : ğ“’   âˆ£ A âŸ¶ B
                           {Î² , g} -- Î² : ğ“ğ“ªğ“½ âˆ£ ğ“– âŸ¶ ğ“—
                                   -- g : ğ“’   âˆ£ B âŸ¶ C
                           â†’ begin
            (Î² âˆ˜â‚ Î±) â‚ C â‚ âˆ˜ ğ“• â‚ (g âˆ˜ f)           â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ resp-âˆ˜â‚‚ ğ“• âŸ©
            (Î² â‚ C â‚ âˆ˜ Î± â‚ C â‚) âˆ˜ (ğ“• â‚ g âˆ˜ ğ“• â‚ f)  â†“âŸ¨ âˆ˜-assoc ğ““ âŸ©
            Î² â‚ C â‚ âˆ˜ (Î± â‚ C â‚ âˆ˜ (ğ“• â‚ g âˆ˜ ğ“• â‚ f))  â†‘âŸ¨ refl âŸ©âˆ˜âŸ¨ âˆ˜-assoc ğ““ âŸ©
            Î² â‚ C â‚ âˆ˜ ((Î± â‚ C â‚ âˆ˜ ğ“• â‚ g) âˆ˜ ğ“• â‚ f)  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ natural Î± âŸ©âˆ˜âŸ¨ refl âŸ©
            Î² â‚ C â‚ âˆ˜ ((ğ“– â‚ g âˆ˜ Î± â‚ B â‚) âˆ˜ ğ“• â‚ f)  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ âˆ˜-assoc ğ““ âŸ©
            Î² â‚ C â‚ âˆ˜ (ğ“– â‚ g âˆ˜ (Î± â‚ B â‚ âˆ˜ ğ“• â‚ f))  â†‘âŸ¨ âˆ˜-assoc ğ““ âŸ©
            (Î² â‚ C â‚ âˆ˜ ğ“– â‚ g) âˆ˜ (Î± â‚ B â‚ âˆ˜ ğ“• â‚ f)  âˆ }
          }

        Æ›_ : âˆ€ {ğ“’ ğ““ ğ“§} â†’ ğ“§ Ã— ğ“’ âŸ¶ ğ““ â†’ ğ“§ âŸ¶ [ ğ“’ , ğ““ ]
        Æ›_ {ğ“’} {ğ““} {ğ“§} ğ“• =
          let open CategoryReasoning ğ““
          in record
          { _â‚€_      = Î» A â†’ record
            { _â‚€_      = Î» B â†’ ğ“• â‚€ (A , B)
            ; _â‚_      = Î» {Bâ‚ Bâ‚‚} (b : ğ“’ âˆ£ Bâ‚ âŸ¶ Bâ‚‚) â†’ ğ“• â‚ (idâ‚ A â‚ , b)
            ; _â‚-cong_ = Î» {Bâ‚ Bâ‚‚} {bâ‚ bâ‚‚ : ğ“’ âˆ£ Bâ‚ âŸ¶ Bâ‚‚} bâ‚âˆ¼bâ‚‚ â†’ ğ“• â‚-cong (reflâ‚ idâ‚ A â‚ â‚ , bâ‚âˆ¼bâ‚‚)
            ; resp-âˆ˜â‚€  = resp-âˆ˜â‚€ ğ“•
            ; resp-âˆ˜â‚‚  = Î» {Bâ‚ Bâ‚‚ Bâ‚ƒ}
                           {bâ‚ : ğ“’ âˆ£ Bâ‚ âŸ¶ Bâ‚‚}
                           {bâ‚‚ : ğ“’ âˆ£ Bâ‚‚ âŸ¶ Bâ‚ƒ} â†’ begin
              ğ“• â‚ (id , bâ‚‚ âˆ˜ bâ‚)             â†‘âŸ¨ ğ“• â‚-cong (âˆ˜-unitË¡ ğ“§ , refl) âŸ©
              ğ“• â‚ (id âˆ˜ id , bâ‚‚ âˆ˜ bâ‚)        â†“âŸ¨ resp-âˆ˜â‚‚ ğ“• âŸ©
              ğ“• â‚ (id , bâ‚‚) âˆ˜ ğ“• â‚ (id , bâ‚)  âˆ
            }
          ; _â‚_      = Î» {Aâ‚ Aâ‚‚} (a : ğ“§ âˆ£ Aâ‚ âŸ¶ Aâ‚‚) â†’ record
            { _â‚_â‚    = Î» B â†’ ğ“• â‚ (a , idâ‚ B â‚)
            ; natural = Î» {Bâ‚ Bâ‚‚}
                          {b : ğ“’ âˆ£ Bâ‚ âŸ¶ Bâ‚‚} â†’ begin
              ğ“• â‚ (a , id) âˆ˜ ğ“• â‚ (id , b)  â†‘âŸ¨ resp-âˆ˜â‚‚ ğ“• âŸ©
              ğ“• â‚ (a âˆ˜ id , id âˆ˜ b)        â†“âŸ¨ ğ“• â‚-cong (â—â†’â–· ğ“§ (âˆ˜-unitÊ³ ğ“§) (âˆ˜-unitË¡ ğ“§) , â—â†’â–· ğ“’ (âˆ˜-unitË¡ ğ“’) (âˆ˜-unitÊ³ ğ“’)) âŸ©
              ğ“• â‚ (id âˆ˜ a , b âˆ˜ id)        â†“âŸ¨ resp-âˆ˜â‚‚ ğ“• âŸ©
              ğ“• â‚ (id , b) âˆ˜ ğ“• â‚ (a , id)  âˆ
            }
          ; _â‚-cong_ = Î» {Aâ‚ Aâ‚‚} {aâ‚ aâ‚‚ : ğ“§ âˆ£ Aâ‚ âŸ¶ Aâ‚‚} aâ‚âˆ¼aâ‚‚ {B} â†’ ğ“• â‚-cong (aâ‚âˆ¼aâ‚‚ , reflâ‚ idâ‚ B â‚ â‚)
          ; resp-âˆ˜â‚€  = resp-âˆ˜â‚€ ğ“•
          ; resp-âˆ˜â‚‚  = Î» {Aâ‚ Aâ‚‚ Aâ‚ƒ}
                         {aâ‚ : ğ“§ âˆ£ Aâ‚ âŸ¶ Aâ‚‚}
                         {aâ‚‚ : ğ“§ âˆ£ Aâ‚‚ âŸ¶ Aâ‚ƒ} â†’ begin
            ğ“• â‚ (aâ‚‚ âˆ˜ aâ‚ , id)             â†‘âŸ¨ ğ“• â‚-cong (refl , âˆ˜-unitÊ³ ğ“’) âŸ©
            ğ“• â‚ (aâ‚‚ âˆ˜ aâ‚ , id âˆ˜ id)        â†“âŸ¨ resp-âˆ˜â‚‚ ğ“• âŸ©
            ğ“• â‚ (aâ‚‚ , id) âˆ˜ ğ“• â‚ (aâ‚ , id)  âˆ
          }
    in record
    { ğŸ™   = ğŸ™
    ; _Ã—_ = _Ã—_
    ; _â‡’_ = _â‡’_
    ; !     = !
    ; Ï€â‚    = Î» {ğ“’ ğ““} â†’ Ï€â‚ {ğ“’} {ğ““}
    ; Ï€â‚‚    = Î» {ğ“’ ğ““} â†’ Ï€â‚‚ {ğ“’} {ğ““}
    ; âŸ¨_,_âŸ© = âŸ¨_,_âŸ©
    ; Îµ     = Îµ
    ; Æ›_    = Æ›_
    }

{-
ğ“’ğ“ªğ“½âœ“ : CartesianClosed ğ“’ğ“ªğ“½
ğ“’ğ“ªğ“½âœ“ = record
  { !-universal   = Î» { {â‡ = â‡} â†’ reflâ‚ â‡ â‚ }
  ; âŸ¨,âŸ©-congâ‚‚     = Î» { (â‰¡-refl , ğ“•â‚âˆ¼ğ“•â€²â‚) (â‰¡-refl , ğ“–â‚âˆ¼ğ“–â€²â‚) â†’ â‰¡-refl , Î» fâˆ¼fâ€² â†’ ğ“•â‚âˆ¼ğ“•â€²â‚ fâˆ¼fâ€² , ğ“–â‚âˆ¼ğ“–â€²â‚ fâˆ¼fâ€² }
  ; âŸ¨,âŸ©-commuteâ‚  = Î» { {f = ğ“•} â†’ reflâ‚ ğ“• â‚ }
  ; âŸ¨,âŸ©-commuteâ‚‚  = Î» { {g = ğ“–} â†’ reflâ‚ ğ“– â‚ }
  ; âŸ¨,âŸ©-universal = Î» { (â‰¡-refl , â‡-commuteâ‚) (â‰¡-refl , â‡-commuteâ‚‚) â†’ â‰¡-refl , Î» fâˆ¼fâ€² â†’ â‡-commuteâ‚ fâˆ¼fâ€² , â‡-commuteâ‚‚ fâˆ¼fâ€² }
  ; Æ›-cong        = Î» { (â‰¡-refl , ğ“•â‚âˆ¼ğ“•â€²â‚) â†’ funext (Î» A â†’ {!!}) , {!!} }
  ; Æ›-commute     = {!!}
  ; Æ›-universal   = {!!}
  }
-}
