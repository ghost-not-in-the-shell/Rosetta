{-# OPTIONS --type-in-type #-}
open import Rosetta.Category
module Rosetta.Yoneda (­ЮЊњ : Category) where
open import Rosetta.Equivalence
open import Rosetta.Functor
open import Rosetta.Functors
open import Rosetta.HomFunctor ­ЮЊњ
open import Rosetta.Isomorphism
open import Rosetta.NaturalTransformation
open import Rosetta.Prelude
open import Rosetta.Setoids
open import Rosetta.DiagrammaticReasoning [ ­ЮЊњ рхњрхќ , ­ЮЊб­ЮЊ«­ЮЊй ]

­ЮЊ▒РѓІРЪ╣_ : Рѕђ (­ЮЊЋ : ­ЮЊњ рхњрхќ РЪХ ­ЮЊб­ЮЊ«­ЮЊй) Рєњ ­ЮЊњ рхњрхќ РЪХ ­ЮЊб­ЮЊ«­ЮЊй
­ЮЊ▒РѓІРЪ╣ ­ЮЊЋ = record
  { _Рѓђ_ = ╬╗ A Рєњ record
    { РѕБ_РѕБ = ­ЮЊ▒РѓЇ A РѓјРѓђ РЪ╣ ­ЮЊЋ
    ; _Рѕ╝_ = ­ЮЊЮ­ЮЊф­ЮЊйРѕБ_РЅѕ_
    }
  ; _РѓЂ_ = ╬╗ {A B} (f : ­ЮЊњ рхњрхќ РѕБ A РЪХ B) Рєњ record
    { _Рѓђ_ = ╬╗ (╬▒ : ­ЮЊ▒РѓЇ A РѓјРѓђ РЪ╣ ­ЮЊЋ) Рєњ ╬▒ РІє ­ЮЊ▒РѓЇ f РѓјРѓЂ
    ; _РѓЂ_ = ╬╗ {╬▒ ╬▓ : ­ЮЊ▒РѓЇ A РѓјРѓђ РЪ╣ ­ЮЊЋ} ╬▒РЅѕ╬▓ Рєњ begin
      ╬▒ РІє ­ЮЊ▒РѓЇ f РѓјРѓЂ  РєЊРЪе Рѕў-congРѓѓ [ ­ЮЊњ рхњрхќ , ­ЮЊб­ЮЊ«­ЮЊй ] {fРѓЂ = ­ЮЊ▒РѓЇ f РѓјРѓЂ} {­ЮЊ▒РѓЇ f РѓјРѓЂ} {╬▒} {╬▓} ╬▒РЅѕ╬▓ reflРѓЇ ­ЮЊ▒РѓЇ f РѓјРѓЂ Рѓј РЪЕ
      ╬▓ РІє ­ЮЊ▒РѓЇ f РѓјРѓЂ  Рѕј
    }
  ; _Рѓѓ_ = ╬╗ {A B}
            {f g : ­ЮЊњ рхњрхќ РѕБ A РЪХ B}
            fРЅѕg
            {╬▒ ╬▓ : ­ЮЊ▒РѓЇ A РѓјРѓђ РЪ╣ ­ЮЊЋ}
            ╬▒РЅѕ╬▓ Рєњ begin
    ╬▒ РІє ­ЮЊ▒РѓЇ f РѓјРѓЂ  РєЊРЪе Рѕў-congРѓѓ [ ­ЮЊњ рхњрхќ , ­ЮЊб­ЮЊ«­ЮЊй ] {fРѓЂ = ­ЮЊ▒РѓЇ f РѓјРѓЂ} {­ЮЊ▒РѓЇ g РѓјРѓЂ} {╬▒} {╬▓} ╬▒РЅѕ╬▓ (­ЮЊ▒РѓІ Рѓѓ fРЅѕg) РЪЕ
    ╬▓ РІє ­ЮЊ▒РѓЇ g РѓјРѓЂ  Рѕј
  ; resp-РѕўРѓђ = ╬╗ {A}
                {╬▒ ╬▓ : ­ЮЊ▒РѓЇ A РѓјРѓђ РЪ╣ ­ЮЊЋ}
                ╬▒РЅѕ╬▓ Рєњ begin
    ╬▒ РІє ­ЮЊ▒РѓЇ idРѓЇ A Рѓј РѓјРѓЂ  РєЊРЪе Рѕў-congРѓѓ [ ­ЮЊњ рхњрхќ , ­ЮЊб­ЮЊ«­ЮЊй ] {fРѓЂ = ­ЮЊ▒РѓЇ idРѓЇ A Рѓј РѓјРѓЂ} {id} {╬▒} {╬▓} ╬▒РЅѕ╬▓ (resp-РѕўРѓђ ­ЮЊ▒РѓІ) РЪЕ
    ╬▓ РІє id             РєЊРЪе Рѕў-unit╩│ [ ­ЮЊњ рхњрхќ , ­ЮЊб­ЮЊ«­ЮЊй ] {f = ╬▓} РЪЕ
    ╬▓                  Рѕј
  ; resp-РѕўРѓѓ = ╬╗ {A B C}
                {f : ­ЮЊњ рхњрхќ РѕБ A РЪХ B}
                {g : ­ЮЊњ рхњрхќ РѕБ B РЪХ C}
                {╬▒ ╬▓ : ­ЮЊ▒РѓЇ A РѓјРѓђ РЪ╣ ­ЮЊЋ}
                ╬▒РЅѕ╬▓ Рєњ begin
    ╬▒ РІє ­ЮЊ▒РѓЇ g Рѕў╠Ё f РѓјРѓЂ          РєЊРЪе Рѕў-congРѓѓ [ ­ЮЊњ рхњрхќ , ­ЮЊб­ЮЊ«­ЮЊй ] {fРѓЂ = ­ЮЊ▒РѓЇ g Рѕў╠Ё f РѓјРѓЂ} {­ЮЊ▒РѓЇ f РѓјРѓЂ РІє ­ЮЊ▒РѓЇ g РѓјРѓЂ} {╬▒} {╬▓} ╬▒РЅѕ╬▓ (resp-РѕўРѓѓ ­ЮЊ▒РѓІ) РЪЕ
    ╬▓ РІє (­ЮЊ▒РѓЇ f РѓјРѓЂ РІє ­ЮЊ▒РѓЇ g РѓјРѓЂ)  Рѕј
  }

yoneda : Рѕђ (­ЮЊЋ : ­ЮЊњ рхњрхќ РЪХ ­ЮЊб­ЮЊ«­ЮЊй) Рєњ [ ­ЮЊњ рхњрхќ , ­ЮЊб­ЮЊ«­ЮЊй ] РѕБ (­ЮЊ▒РѓІРЪ╣ ­ЮЊЋ) РЅЃ ­ЮЊЋ
yoneda ­ЮЊЋ = record
  { to   = record
    { _РѓЇ_Рѓј    = ╬╗ C Рєњ record
      { _Рѓђ_ = ╬╗ (╬и : ­ЮЊ▒РѓЇ C РѓјРѓђ РЪ╣ ­ЮЊЋ) Рєњ (╬и РѓЇ C Рѓј) Рѓђ id
      ; _РѓЂ_ = ╬╗ {╬иРѓЂ ╬иРѓѓ : ­ЮЊ▒РѓЇ C РѓјРѓђ РЪ╣ ­ЮЊЋ} ╬иРѓЂРЅѕ╬иРѓѓ Рєњ ╬иРѓЂРЅѕ╬иРѓѓ C refl
      }
    ; natural = {!!}
    }
  ; from = record
    { _РѓЇ_Рѓј    = ╬╗ C Рєњ record
      { _Рѓђ_ = ╬╗ (c : РѕБ ­ЮЊЋ Рѓђ C РѕБ) Рєњ record
        { _РѓЇ_Рѓј    = ╬╗ D Рєњ record
          { _Рѓђ_ = ╬╗ (f : ­ЮЊњ рхњрхќ РѕБ C РЪХ D) Рєњ (­ЮЊЋ РѓЂ f) Рѓђ c
          ; _РѓЂ_ = ╬╗ {fРѓЂ fРѓѓ : ­ЮЊњ рхњрхќ РѕБ C РЪХ D} fРѓЂРЅѕfРѓѓ Рєњ (­ЮЊЋ Рѓѓ fРѓЂРЅѕfРѓѓ) (IsEquivalence.refl (Setoid.Рѕ╝-equiv (­ЮЊЋ Рѓђ C)))
          }
        ; natural = ╬╗ {DРѓЂ DРѓѓ}
                      {d     : ­ЮЊњ рхњрхќ РѕБ DРѓЂ РЪХ DРѓѓ}
                      {fРѓЂ fРѓѓ : ­ЮЊњ рхњрхќ РѕБ C  РЪХ DРѓЂ}
                      fРѓЂРЅѕfРѓѓ Рєњ {!!}
        }
      ; _РѓЂ_ = {!!}
      }
    ; natural = {!!}
    }
  ; inverse╦А = {!!}
  ; inverse╩│ = {!!}
  }
