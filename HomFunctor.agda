{-# OPTIONS --type-in-type #-}
open import Rosetta.Category
module Rosetta.HomFunctor (ğ“’ : Category) where
open import Rosetta.DiagrammaticReasoning ğ“’
open import Rosetta.Equivalence
open import Rosetta.Functor
open import Rosetta.Functors
open import Rosetta.Prelude
open import Rosetta.Setoids

module Covariant (B : ob ğ“’) where
  ğ“±ğ“¸ğ“¶â‚_,Bâ‚â‚€ : ob (ğ“’ áµ’áµ–) â†’ Setoid
  ğ“±ğ“¸ğ“¶â‚ A ,Bâ‚â‚€ = ğ’‰ğ’ğ’ ğ“’ A B

  ğ“±ğ“¸ğ“¶â‚_,Bâ‚â‚ : âˆ€ {A Aâ€²}
    â†’ ğ“’ áµ’áµ– âˆ£      A      âŸ¶      Aâ€²
    â†’ ğ“¢ğ“®ğ“½  âˆ£ ğ“±ğ“¸ğ“¶â‚ A ,Bâ‚â‚€ âŸ¶ ğ“±ğ“¸ğ“¶â‚ Aâ€² ,Bâ‚â‚€
  ğ“±ğ“¸ğ“¶â‚ f ,Bâ‚â‚ = record
    { _â‚€_ =  _âˆ˜        f
    ; _â‚_ = _âŸ©âˆ˜âŸ¨ reflâ‚ f â‚
    }

  ğ“±ğ“¸ğ“¶â‚-,Bâ‚ : ğ“’ áµ’áµ– âŸ¶ ğ“¢ğ“®ğ“½
  ğ“±ğ“¸ğ“¶â‚-,Bâ‚ = record
    { _â‚€_ = ğ“±ğ“¸ğ“¶â‚_,Bâ‚â‚€
    ; _â‚_ = ğ“±ğ“¸ğ“¶â‚_,Bâ‚â‚
    ; _â‚‚_ = Î» {A Aâ€²}
              {fâ‚ fâ‚‚ : ğ“’ áµ’áµ– âˆ£ A âŸ¶ Aâ€²}
              fâ‚â‰ˆfâ‚‚
              {gâ‚ gâ‚‚ : ğ“’    âˆ£ A âŸ¶ B }
              gâ‚â‰ˆgâ‚‚ â†’ âˆ˜-congâ‚‚ ğ“’ gâ‚â‰ˆgâ‚‚ fâ‚â‰ˆfâ‚‚
    ; resp-âˆ˜â‚€ = Î» {A}
                  {gâ‚ gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B}
                  gâ‚â‰ˆgâ‚‚ â†’ begin
      gâ‚ âˆ˜ id  â†“âŸ¨ âˆ˜-unitÊ³ ğ“’ âŸ©
      gâ‚       â†“âŸ¨ gâ‚â‰ˆgâ‚‚ âŸ©
      gâ‚‚       âˆ
    ; resp-âˆ˜â‚‚ = Î» {A Aâ€² Aâ€³}
                  {f     : ğ“’ áµ’áµ– âˆ£ A  âŸ¶ Aâ€²}
                  {fâ€²    : ğ“’ áµ’áµ– âˆ£ Aâ€² âŸ¶ Aâ€³}
                  {gâ‚ gâ‚‚ : ğ“’    âˆ£ A  âŸ¶ B }
                  gâ‚â‰ˆgâ‚‚ â†’ begin
      gâ‚ âˆ˜ (fâ€² âˆ˜Ì… f)  â†“âŸ¨ gâ‚â‰ˆgâ‚‚ âŸ©âˆ˜âŸ¨ refl âŸ©
      gâ‚‚ âˆ˜ (f âˆ˜ fâ€²)  â†‘âŸ¨ âˆ˜-assoc ğ“’ âŸ©
      (gâ‚‚ âˆ˜ f) âˆ˜ fâ€²  âˆ
    }

open Covariant

ğ“±ğ“¸ğ“¶â‚_,_â‚â‚€ : ob (ğ“’ áµ’áµ–) â†’ âˆ€ B â†’ Setoid
ğ“±ğ“¸ğ“¶â‚ A , B â‚â‚€ = ğ“±ğ“¸ğ“¶â‚_,Bâ‚â‚€ B A

ğ“±ğ“¸ğ“¶â‚_,_â‚â‚ : âˆ€ {A Aâ€²}
  â†’ ğ“’ áµ’áµ– âˆ£      A        âŸ¶      Aâ€²
  â†’ âˆ€ B
  â†’ ğ“¢ğ“®ğ“½  âˆ£ ğ“±ğ“¸ğ“¶â‚ A , B â‚â‚€ âŸ¶ ğ“±ğ“¸ğ“¶â‚ Aâ€² , B â‚â‚€
ğ“±ğ“¸ğ“¶â‚ f , B â‚â‚ = ğ“±ğ“¸ğ“¶â‚_,Bâ‚â‚ B f

ğ“±ğ“¸ğ“¶â‚-,_â‚ : ob ğ“’ â†’ ğ“’ áµ’áµ– âŸ¶ ğ“¢ğ“®ğ“½
ğ“±ğ“¸ğ“¶â‚-, B â‚ = ğ“±ğ“¸ğ“¶â‚-,Bâ‚ B

ğ“±â‚_â‚â‚€ = ğ“±ğ“¸ğ“¶â‚-,_â‚

module Contravariant (A : ob (ğ“’ áµ’áµ–)) where
  ğ“±ğ“¸ğ“¶â½A,_â¾â° : ob ğ“’ â†’ Setoid
  ğ“±ğ“¸ğ“¶â½A, B â¾â° = ğ’‰ğ’ğ’ ğ“’ A B

  ğ“±ğ“¸ğ“¶â½A,_â¾Â¹ : âˆ€ {B Bâ€²}
    â†’ ğ“’   âˆ£        B    âŸ¶        Bâ€²
    â†’ ğ“¢ğ“®ğ“½ âˆ£ ğ“±ğ“¸ğ“¶â½A, B â¾â° âŸ¶ ğ“±ğ“¸ğ“¶â½A, Bâ€² â¾â°
  ğ“±ğ“¸ğ“¶â½A, h â¾Â¹ = record
    { _â‚€_ =       h    âˆ˜_
    ; _â‚_ = reflâ‚ h â‚ âŸ©âˆ˜âŸ¨_
    }

  ğ“±ğ“¸ğ“¶â½A,-â¾ : ğ“’ âŸ¶ ğ“¢ğ“®ğ“½
  ğ“±ğ“¸ğ“¶â½A,-â¾ = record
    { _â‚€_ = ğ“±ğ“¸ğ“¶â½A,_â¾â°
    ; _â‚_ = ğ“±ğ“¸ğ“¶â½A,_â¾Â¹
    ; _â‚‚_ = Î» {B Bâ€²}
              {hâ‚ hâ‚‚ : ğ“’ âˆ£ B âŸ¶ Bâ€²}
              hâ‚â‰ˆhâ‚‚
              {gâ‚ gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B }
              gâ‚â‰ˆgâ‚‚ â†’ âˆ˜-congâ‚‚ ğ“’ hâ‚â‰ˆhâ‚‚ gâ‚â‰ˆgâ‚‚
    ; resp-âˆ˜â‚€ = Î» {B}
                  {gâ‚ gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B}
                  gâ‚â‰ˆgâ‚‚ â†’ begin
      id âˆ˜ gâ‚  â†“âŸ¨ âˆ˜-unitË¡ ğ“’ âŸ©
      gâ‚       â†“âŸ¨ gâ‚â‰ˆgâ‚‚ âŸ©
      gâ‚‚       âˆ
    ; resp-âˆ˜â‚‚ = Î» {B Bâ€² Bâ€³}
                  {h     : ğ“’ âˆ£ B  âŸ¶ Bâ€²}
                  {hâ€²    : ğ“’ âˆ£ Bâ€² âŸ¶ Bâ€³}
                  {gâ‚ gâ‚‚ : ğ“’ âˆ£ A  âŸ¶ B }
                  gâ‚â‰ˆgâ‚‚ â†’ begin
      (hâ€² âˆ˜ h) âˆ˜ gâ‚  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ gâ‚â‰ˆgâ‚‚ âŸ©
      (hâ€² âˆ˜ h) âˆ˜ gâ‚‚  â†“âŸ¨ âˆ˜-assoc ğ“’ âŸ©
      hâ€² âˆ˜ (h âˆ˜ gâ‚‚)  âˆ
    }

open Contravariant public renaming
  ( ğ“±ğ“¸ğ“¶â½A,_â¾â° to ğ“±ğ“¸ğ“¶â½_,_â¾â°
  ; ğ“±ğ“¸ğ“¶â½A,_â¾Â¹ to ğ“±ğ“¸ğ“¶â½_,_â¾Â¹
  ; ğ“±ğ“¸ğ“¶â½A,-â¾  to ğ“±ğ“¸ğ“¶â½_,-â¾
  )

ğ“±â½_â¾â° = ğ“±ğ“¸ğ“¶â½_,-â¾

module Naturality where
  ğ“±â‚_â‚â‚ : âˆ€ {B Bâ€²}
    â†’ ğ“’              âˆ£    B    âŸ¶    Bâ€²
    â†’ [ ğ“’ áµ’áµ– , ğ“¢ğ“®ğ“½ ] âˆ£ ğ“±â‚ B â‚â‚€ âŸ¶ ğ“±â‚ Bâ€² â‚â‚€
  ğ“±â‚_â‚â‚ {B} {Bâ€²} h = record
    { _â‚_â‚    = Î» A â†’ ğ“±ğ“¸ğ“¶â½ A , h â¾Â¹
    ; natural = Î» {A Aâ€²}
                  {f     : ğ“’ áµ’áµ– âˆ£ A âŸ¶ Aâ€²}
                  {gâ‚ gâ‚‚ : ğ“’    âˆ£ A âŸ¶ B }
                  gâ‚â‰ˆgâ‚‚ â†’ begin
      h âˆ˜ (gâ‚ âˆ˜ f)  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ gâ‚â‰ˆgâ‚‚ âŸ©âˆ˜âŸ¨ refl âŸ©
      h âˆ˜ (gâ‚‚ âˆ˜ f)  â†‘âŸ¨ âˆ˜-assoc ğ“’ âŸ©
      (h âˆ˜ gâ‚‚) âˆ˜ f  âˆ
    }

  ğ“±â½_â¾Â¹ : âˆ€ {A Aâ€²}
    â†’ ğ“’ áµ’áµ–        âˆ£    A    âŸ¶    Aâ€²
    â†’ [ ğ“’ , ğ“¢ğ“®ğ“½ ] âˆ£ ğ“±â½ A â¾â° âŸ¶ ğ“±â½ Aâ€² â¾â°
  ğ“±â½_â¾Â¹ {A} {Aâ€²} f = record
    { _â‚_â‚    = Î» B â†’ ğ“±ğ“¸ğ“¶â‚ f , B â‚â‚
    ; natural = Î» {B Bâ€²}
                  {h     : ğ“’ âˆ£ B âŸ¶ Bâ€²}
                  {gâ‚ gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B }
                  gâ‚â‰ˆgâ‚‚ â†’ begin
      (h âˆ˜ gâ‚) âˆ˜ f  â†“âŸ¨ âˆ˜-assoc ğ“’ âŸ©
      h âˆ˜ (gâ‚ âˆ˜ f)  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ gâ‚â‰ˆgâ‚‚ âŸ©âˆ˜âŸ¨ refl âŸ©
      h âˆ˜ (gâ‚‚ âˆ˜ f)  âˆ
    }

open Naturality public

module Yoneda where
  ğ“±â‚‹ : ğ“’ âŸ¶ [ ğ“’ áµ’áµ– , ğ“¢ğ“®ğ“½ ]
  ğ“±â‚‹ = record
    { _â‚€_ = ğ“±â‚_â‚â‚€
    ; _â‚_ = ğ“±â‚_â‚â‚
    ; _â‚‚_ = Î» {B Bâ€²}
              {hâ‚ hâ‚‚ : ğ“’ âˆ£ B âŸ¶ Bâ€²}
              hâ‚â‰ˆhâ‚‚ A
              {gâ‚ gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B }
              gâ‚â‰ˆgâ‚‚ â†’ âˆ˜-congâ‚‚ ğ“’ hâ‚â‰ˆhâ‚‚ gâ‚â‰ˆgâ‚‚
    ; resp-âˆ˜â‚€ = Î» {B} A
                  {gâ‚ gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B}
                  gâ‚â‰ˆgâ‚‚ â†’ begin
      id âˆ˜ gâ‚  â†“âŸ¨ âˆ˜-unitË¡ ğ“’ âŸ©
      gâ‚       â†“âŸ¨ gâ‚â‰ˆgâ‚‚ âŸ©
      gâ‚‚       âˆ
    ; resp-âˆ˜â‚‚ = Î» {B Bâ€² Bâ€³}
                  {h     : ğ“’ âˆ£ B  âŸ¶ Bâ€²}
                  {hâ€²    : ğ“’ âˆ£ Bâ€² âŸ¶ Bâ€³}
                  A
                  {gâ‚ gâ‚‚ : ğ“’ âˆ£ A  âŸ¶ B }
                  gâ‚â‰ˆgâ‚‚ â†’ begin
      (hâ€² âˆ˜ h) âˆ˜ gâ‚  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ gâ‚â‰ˆgâ‚‚ âŸ©
      (hâ€² âˆ˜ h) âˆ˜ gâ‚‚  â†“âŸ¨ âˆ˜-assoc ğ“’ âŸ©
      hâ€² âˆ˜ (h âˆ˜ gâ‚‚)  âˆ
    }

open Yoneda public

module Yoda where
  ğ“±â» : ğ“’ áµ’áµ– âŸ¶ [ ğ“’ , ğ“¢ğ“®ğ“½ ]
  ğ“±â» = record
    { _â‚€_ = ğ“±â½_â¾â°
    ; _â‚_ = ğ“±â½_â¾Â¹
    ; _â‚‚_ = Î» {A Aâ€²}
              {fâ‚ fâ‚‚ : ğ“’ áµ’áµ– âˆ£ A âŸ¶ Aâ€²}
              fâ‚â‰ˆfâ‚‚ B
              {gâ‚ gâ‚‚ : ğ“’    âˆ£ A âŸ¶ B }
              gâ‚â‰ˆgâ‚‚ â†’ âˆ˜-congâ‚‚ ğ“’ gâ‚â‰ˆgâ‚‚ fâ‚â‰ˆfâ‚‚
    ; resp-âˆ˜â‚€ = Î» {A} B
                  {gâ‚ gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B}
                  gâ‚â‰ˆgâ‚‚ â†’ begin
      gâ‚ âˆ˜ id  â†“âŸ¨ âˆ˜-unitÊ³ ğ“’ âŸ©
      gâ‚       â†“âŸ¨ gâ‚â‰ˆgâ‚‚ âŸ©
      gâ‚‚       âˆ
    ; resp-âˆ˜â‚‚ = Î» {A Aâ€² Aâ€³}
                  {f     : ğ“’ áµ’áµ– âˆ£ A  âŸ¶ Aâ€²}
                  {fâ€²    : ğ“’ áµ’áµ– âˆ£ Aâ€² âŸ¶ Aâ€³}
                  B
                  {gâ‚ gâ‚‚ : ğ“’    âˆ£ A  âŸ¶ B }
                  gâ‚â‰ˆgâ‚‚ â†’ begin
      gâ‚ âˆ˜ (fâ€² âˆ˜Ì… f)  â†“âŸ¨ gâ‚â‰ˆgâ‚‚ âŸ©âˆ˜âŸ¨ refl âŸ©
      gâ‚‚ âˆ˜ (f âˆ˜ fâ€²)  â†‘âŸ¨ âˆ˜-assoc ğ“’ âŸ©
      (gâ‚‚ âˆ˜ f) âˆ˜ fâ€²  âˆ
    }

open Yoda public
