{-# OPTIONS --type-in-type #-}
open import Rosetta.Category
module Rosetta.HomFunctor (ğ“’ : Category) where
open import Rosetta.Prelude
open import Rosetta.Equivalence
open import Rosetta.Setoids
open import Rosetta.DiagrammaticReasoning ğ“’

ğ’‰ğ’ğ’â‚_,_â‚ : ob ğ“’ â†’ ob ğ“’ â†’ Setoid
ğ’‰ğ’ğ’â‚ A , B â‚ = record
  { âˆ£_âˆ£   = ğ“’ âˆ£ A âŸ¶ B
  ; _âˆ£_âˆ¼_ = ğ“’ âˆ£_âˆ¼_
  }

open import Rosetta.Functor
module Covariant (B : ob ğ“’) where
  ğ“±ğ“¸ğ“¶â‚_,Bâ‚â‚€ : ob (ğ“’ áµ’áµ–) â†’ Setoid
  ğ“±ğ“¸ğ“¶â‚ A ,Bâ‚â‚€ = ğ’‰ğ’ğ’â‚ A , B â‚

  ğ“±ğ“¸ğ“¶â‚_,Bâ‚â‚ : âˆ€ {A Aâ€²}
    â†’ ğ“’ áµ’áµ– âˆ£      A      âŸ¶      Aâ€²
    â†’ ğ“¢ğ“®ğ“½  âˆ£ ğ“±ğ“¸ğ“¶â‚ A ,Bâ‚â‚€ âŸ¶ ğ“±ğ“¸ğ“¶â‚ Aâ€² ,Bâ‚â‚€
  ğ“±ğ“¸ğ“¶â‚ f ,Bâ‚â‚ = record
    { _â‚€_ = _âˆ˜ f
    ; _â‚_ = Î» gâ‚âˆ¼gâ‚‚ â†’ âˆ˜-congâ‚‚ ğ“’ gâ‚âˆ¼gâ‚‚ reflâ‚ f â‚
    }

  ğ“±ğ“¸ğ“¶â‚-,Bâ‚ : ğ“’ áµ’áµ– âŸ¶ ğ“¢ğ“®ğ“½
  ğ“±ğ“¸ğ“¶â‚-,Bâ‚ = record
    { _â‚€_ = ğ“±ğ“¸ğ“¶â‚_,Bâ‚â‚€
    ; _â‚_ = ğ“±ğ“¸ğ“¶â‚_,Bâ‚â‚
    ; _â‚‚_ = Î» fâ‚âˆ¼fâ‚‚ gâ‚âˆ¼gâ‚‚ â†’ âˆ˜-congâ‚‚ ğ“’ gâ‚âˆ¼gâ‚‚ fâ‚âˆ¼fâ‚‚
    ; resp-âˆ˜â‚€ = Î» { {x = gâ‚} {gâ‚‚} gâ‚âˆ¼gâ‚‚ â†’ begin
      gâ‚ âˆ˜ id  â†“âŸ¨ âˆ˜-unitÊ³ ğ“’ âŸ©
      gâ‚       â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
      gâ‚‚       âˆ }
    ; resp-âˆ˜â‚‚ = Î» { {f = f} {fâ€²} {gâ‚} {gâ‚‚} gâ‚âˆ¼gâ‚‚ â†’ begin
      gâ‚ âˆ˜ (fâ€² âˆ˜Ì… f)  â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©âˆ˜âŸ¨ refl âŸ©
      gâ‚‚ âˆ˜ (fâ€² âˆ˜Ì… f)  â†‘âŸ¨ âˆ˜-assoc ğ“’ âŸ©
      (gâ‚‚ âˆ˜ f) âˆ˜ fâ€²  âˆ }
    }

open Covariant

ğ“±ğ“¸ğ“¶â‚_,_â‚â‚€ : ob (ğ“’ áµ’áµ–) â†’ âˆ€ B â†’ Setoid
ğ“±ğ“¸ğ“¶â‚ A , B â‚â‚€ = ğ“±ğ“¸ğ“¶â‚_,Bâ‚â‚€ B A

ğ“±ğ“¸ğ“¶â‚_,_â‚â‚ : âˆ€ {A Aâ€²}
  â†’ ğ“’ áµ’áµ– âˆ£      A        âŸ¶      Aâ€²
  â†’ âˆ€ B
  â†’ ğ“¢ğ“®ğ“½  âˆ£ ğ“±ğ“¸ğ“¶â‚ A , B â‚â‚€ âŸ¶ ğ“±ğ“¸ğ“¶â‚ Aâ€² , B â‚â‚€
ğ“±ğ“¸ğ“¶â‚ f , B â‚â‚ = ğ“±ğ“¸ğ“¶â‚_,Bâ‚â‚ B f

ğ“±ğ“¸ğ“¶â‚-,_â‚ : ob ğ“’ â†’ ğ“’ áµ’áµ– âŸ¶ ğ“¢ğ“®ğ“½
ğ“±ğ“¸ğ“¶â‚-, B â‚ = ğ“±ğ“¸ğ“¶â‚-,Bâ‚ B

module Contravariant (A : ob (ğ“’ áµ’áµ–)) where
  ğ“±ğ“¸ğ“¶â½A,_â¾â° : ob ğ“’ â†’ Setoid
  ğ“±ğ“¸ğ“¶â½A, B â¾â° = ğ’‰ğ’ğ’â‚ A , B â‚

  ğ“±ğ“¸ğ“¶â½A,_â¾Â¹ : âˆ€ {B Bâ€²}
    â†’ ğ“’   âˆ£        B    âŸ¶        Bâ€²
    â†’ ğ“¢ğ“®ğ“½ âˆ£ ğ“±ğ“¸ğ“¶â½A, B â¾â° âŸ¶ ğ“±ğ“¸ğ“¶â½A, Bâ€² â¾â°
  ğ“±ğ“¸ğ“¶â½A, h â¾Â¹ = record
    { _â‚€_ = h âˆ˜_
    ; _â‚_ = Î» gâ‚âˆ¼gâ‚‚ â†’ âˆ˜-congâ‚‚ ğ“’ reflâ‚ h â‚ gâ‚âˆ¼gâ‚‚
    }

  ğ“±ğ“¸ğ“¶â½A,-â¾ : ğ“’ âŸ¶ ğ“¢ğ“®ğ“½
  ğ“±ğ“¸ğ“¶â½A,-â¾ = record
    { _â‚€_ = ğ“±ğ“¸ğ“¶â½A,_â¾â°
    ; _â‚_ = ğ“±ğ“¸ğ“¶â½A,_â¾Â¹
    ; _â‚‚_ = Î» hâ‚âˆ¼hâ‚‚ gâ‚âˆ¼gâ‚‚ â†’ âˆ˜-congâ‚‚ ğ“’ hâ‚âˆ¼hâ‚‚ gâ‚âˆ¼gâ‚‚
    ; resp-âˆ˜â‚€ = Î» { {x = gâ‚} {gâ‚‚} gâ‚âˆ¼gâ‚‚ â†’ begin
      id âˆ˜ gâ‚  â†“âŸ¨ âˆ˜-unitË¡ ğ“’ âŸ©
      gâ‚       â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
      gâ‚‚       âˆ }
    ; resp-âˆ˜â‚‚ = Î» { {f = h} {hâ€²} {gâ‚} {gâ‚‚} gâ‚âˆ¼gâ‚‚ â†’ begin
      (hâ€² âˆ˜ h) âˆ˜ gâ‚  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
      (hâ€² âˆ˜ h) âˆ˜ gâ‚‚  â†“âŸ¨ âˆ˜-assoc ğ“’ âŸ©
      hâ€² âˆ˜ (h âˆ˜ gâ‚‚)  âˆ }
    }

open Contravariant public renaming
  ( ğ“±ğ“¸ğ“¶â½A,_â¾â° to ğ“±ğ“¸ğ“¶â½_,_â¾â°
  ; ğ“±ğ“¸ğ“¶â½A,_â¾Â¹ to ğ“±ğ“¸ğ“¶â½_,_â¾Â¹
  ; ğ“±ğ“¸ğ“¶â½A,-â¾  to ğ“±ğ“¸ğ“¶â½_,-â¾
  )

open import Rosetta.NaturalTransformation
module Naturality where
  ğ“±ğ“¸ğ“¶â‚-,Bâ‚âŸ¹ğ“±ğ“¸ğ“¶â‚-,Bâ€²â‚ : âˆ€ {B Bâ€²} (h : ğ“’ âˆ£ B âŸ¶ Bâ€²)
    â†’ ğ“±ğ“¸ğ“¶â‚-, B â‚ âŸ¹ ğ“±ğ“¸ğ“¶â‚-, Bâ€² â‚
  ğ“±ğ“¸ğ“¶â‚-,Bâ‚âŸ¹ğ“±ğ“¸ğ“¶â‚-,Bâ€²â‚ {B} {Bâ€²} h = record
    { _â‚_â‚    = Î» A â†’ ğ“±ğ“¸ğ“¶â½ A , h â¾Â¹
    ; natural = Î» {A} {Aâ€²}
                  {f  : ğ“’ áµ’áµ– âˆ£ A âŸ¶ Aâ€²}
                  {gâ‚ : ğ“’    âˆ£ A âŸ¶ B }
                  {gâ‚‚ : ğ“’    âˆ£ A âŸ¶ B }
                  gâ‚âˆ¼gâ‚‚ â†’ begin
      h âˆ˜ (gâ‚ âˆ˜ f)  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©âˆ˜âŸ¨ refl âŸ©
      h âˆ˜ (gâ‚‚ âˆ˜ f)  â†‘âŸ¨ âˆ˜-assoc ğ“’ âŸ©
      (h âˆ˜ gâ‚‚) âˆ˜ f  âˆ
    }

  ğ“±ğ“¸ğ“¶â½A,-â¾âŸ¹ğ“±ğ“¸ğ“¶â½Aâ€²,-â¾ : âˆ€ {A Aâ€²} (f : ğ“’ áµ’áµ– âˆ£ A âŸ¶ Aâ€²)
    â†’ ğ“±ğ“¸ğ“¶â½ A ,-â¾ âŸ¹ ğ“±ğ“¸ğ“¶â½ Aâ€² ,-â¾
  ğ“±ğ“¸ğ“¶â½A,-â¾âŸ¹ğ“±ğ“¸ğ“¶â½Aâ€²,-â¾ {A} {Aâ€²} f = record
    { _â‚_â‚    = Î» B â†’ ğ“±ğ“¸ğ“¶â‚ f , B â‚â‚
    ; natural = Î» {B} {Bâ€²}
                  {h  : ğ“’ âˆ£ B âŸ¶ Bâ€²}
                  {gâ‚ : ğ“’ âˆ£ A âŸ¶ B }
                  {gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B }
                  gâ‚âˆ¼gâ‚‚ â†’ begin
      (h âˆ˜ gâ‚) âˆ˜ f  â†“âŸ¨ âˆ˜-assoc ğ“’ âŸ©
      h âˆ˜ (gâ‚ âˆ˜ f)  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©âˆ˜âŸ¨ refl âŸ©
      h âˆ˜ (gâ‚‚ âˆ˜ f)  âˆ
    }

open Naturality public

open import Rosetta.Functors
module Yoneda where
  ğ“±â‚‹ : ğ“’ âŸ¶ [ ğ“’ áµ’áµ– , ğ“¢ğ“®ğ“½ ]
  ğ“±â‚‹ = record
    { _â‚€_ = ğ“±ğ“¸ğ“¶â‚-,_â‚
    ; _â‚_ = ğ“±ğ“¸ğ“¶â‚-,Bâ‚âŸ¹ğ“±ğ“¸ğ“¶â‚-,Bâ€²â‚
    ; _â‚‚_ = Î» hâ‚âˆ¼hâ‚‚ gâ‚âˆ¼gâ‚‚ â†’ âˆ˜-congâ‚‚ ğ“’ hâ‚âˆ¼hâ‚‚ gâ‚âˆ¼gâ‚‚
    ; resp-âˆ˜â‚€ = Î» {B} {A}
                  {gâ‚ : ğ“’ âˆ£ A âŸ¶ B}
                  {gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B}
                  gâ‚âˆ¼gâ‚‚ â†’ begin
      id âˆ˜ gâ‚  â†“âŸ¨ âˆ˜-unitË¡ ğ“’ âŸ©
      gâ‚       â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
      gâ‚‚       âˆ
    ; resp-âˆ˜â‚‚ = Î» {B} {Bâ€²} {Bâ€³}
                  {h  : ğ“’ âˆ£ B  âŸ¶ Bâ€²}
                  {hâ€² : ğ“’ âˆ£ Bâ€² âŸ¶ Bâ€³}
                  {A}
                  {gâ‚ : ğ“’ âˆ£ A  âŸ¶ B }
                  {gâ‚‚ : ğ“’ âˆ£ A  âŸ¶ B }
                  gâ‚âˆ¼gâ‚‚ â†’ begin
      (hâ€² âˆ˜ h) âˆ˜ gâ‚  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
      (hâ€² âˆ˜ h) âˆ˜ gâ‚‚  â†“âŸ¨ âˆ˜-assoc ğ“’ âŸ©
      hâ€² âˆ˜ (h âˆ˜ gâ‚‚)  âˆ
    }

open Yoneda public

module Yoda where
  ğ“±â» : ğ“’ áµ’áµ– âŸ¶ [ ğ“’ , ğ“¢ğ“®ğ“½ ]
  ğ“±â» = record
    { _â‚€_ = ğ“±ğ“¸ğ“¶â½_,-â¾
    ; _â‚_ = ğ“±ğ“¸ğ“¶â½A,-â¾âŸ¹ğ“±ğ“¸ğ“¶â½Aâ€²,-â¾
    ; _â‚‚_ = Î» fâ‚âˆ¼fâ‚‚ gâ‚âˆ¼gâ‚‚ â†’ âˆ˜-congâ‚‚ ğ“’ gâ‚âˆ¼gâ‚‚ fâ‚âˆ¼fâ‚‚
    ; resp-âˆ˜â‚€ = Î» {A} {B}
                  {gâ‚ : ğ“’ âˆ£ A âŸ¶ B}
                  {gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B}
                  gâ‚âˆ¼gâ‚‚ â†’ begin
                  gâ‚ âˆ˜ id  â†“âŸ¨ âˆ˜-unitÊ³ ğ“’ âŸ©
                  gâ‚       â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
                  gâ‚‚       âˆ
    ; resp-âˆ˜â‚‚ = Î» {A} {Aâ€²} {Aâ€³}
                  {f  : ğ“’ áµ’áµ– âˆ£ A  âŸ¶ Aâ€²}
                  {fâ€² : ğ“’ áµ’áµ– âˆ£ Aâ€² âŸ¶ Aâ€³}
                  {B}
                  {gâ‚ : ğ“’    âˆ£ A  âŸ¶ B }
                  {gâ‚‚ : ğ“’    âˆ£ A  âŸ¶ B }
                  gâ‚âˆ¼gâ‚‚ â†’ begin
      gâ‚ âˆ˜ (fâ€² âˆ˜Ì… f)  â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©âˆ˜âŸ¨ refl âŸ©
      gâ‚‚ âˆ˜ (fâ€² âˆ˜Ì… f)  â†‘âŸ¨ âˆ˜-assoc ğ“’ âŸ©
      (gâ‚‚ âˆ˜ f) âˆ˜ fâ€²  âˆ
    }

open Yoda public
