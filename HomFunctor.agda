{-# OPTIONS --type-in-type #-}
open import Rosetta.Category
module Rosetta.HomFunctor (ğ“’ : Category) where
open import Rosetta.Categories; open ğ“’ğ“ªğ“½
open import Rosetta.DiagramChasing ğ“’
open import Rosetta.Equivalence
open import Rosetta.Functor
open import Rosetta.Functors
open import Rosetta.Prelude
open import Rosetta.Setoids
open CategoryReasoning ğ“’

ğ“±ğ“¸ğ“¶â‚_,_â‚ : âˆ€ {A Aâ€²}
  â†’ ğ“’ áµ’áµ– âˆ£       A   âŸ¶       Aâ€²
  â†’ âˆ€ B
  â†’ ğ“¢ğ“®ğ“½  âˆ£ ğ’‰ğ’ğ’ ğ“’ A B âŸ¶ ğ’‰ğ’ğ’ ğ“’ Aâ€² B
ğ“±ğ“¸ğ“¶â‚ f , B â‚ = record
  { _â‚€_ =  _âˆ˜        f
  ; _â‚_ = _âŸ©âˆ˜âŸ¨ reflâ‚ f â‚
  }

ğ“±ğ“¸ğ“¶â‚-,_â‚ : âˆ€ B â†’ ğ“’ áµ’áµ– âŸ¶ ğ“¢ğ“®ğ“½
ğ“±ğ“¸ğ“¶â‚-, B â‚ = record
  { _â‚€_ = Î» - â†’ ğ’‰ğ’ğ’ ğ“’ - B
  ; _â‚_ = ğ“±ğ“¸ğ“¶â‚_, B â‚
  ; _â‚‚_ = Î» fâ‚âˆ¼fâ‚‚ gâ‚âˆ¼gâ‚‚ â†’ gâ‚âˆ¼gâ‚‚ âŸ©âˆ˜âŸ¨ fâ‚âˆ¼fâ‚‚
  ; resp-âˆ˜â‚€ = Î» {A}
                {gâ‚ gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B}
                gâ‚âˆ¼gâ‚‚ â†’ begin
    gâ‚ âˆ˜ id  â†“âŸ¨ âˆ˜-unitÊ³ ğ“’ âŸ©
    gâ‚       â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
    gâ‚‚       âˆ
  ; resp-âˆ˜â‚‚ = Î» {A Aâ€² Aâ€³}
                {f     : ğ“’ áµ’áµ– âˆ£ A  âŸ¶ Aâ€²}
                {fâ€²    : ğ“’ áµ’áµ– âˆ£ Aâ€² âŸ¶ Aâ€³}
                {gâ‚ gâ‚‚ : ğ“’    âˆ£ A  âŸ¶ B }
                gâ‚âˆ¼gâ‚‚ â†’ begin
    gâ‚ âˆ˜ (fâ€² âˆ˜Ì… f)  â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©âˆ˜âŸ¨ refl âŸ©
    gâ‚‚ âˆ˜ (f âˆ˜ fâ€²)  â†‘âŸ¨ âˆ˜-assoc ğ“’ âŸ©
    (gâ‚‚ âˆ˜ f) âˆ˜ fâ€²  âˆ
  }

ğ“±â‚_â‚â‚€ = ğ“±ğ“¸ğ“¶â‚-,_â‚

ğ“±ğ“¸ğ“¶â½_,_â¾ : âˆ€ A {B Bâ€²}
  â†’ ğ“’   âˆ£         B âŸ¶         Bâ€²
  â†’ ğ“¢ğ“®ğ“½ âˆ£ ğ’‰ğ’ğ’ ğ“’ A B âŸ¶ ğ’‰ğ’ğ’ ğ“’ A Bâ€²
ğ“±ğ“¸ğ“¶â½ A , h â¾ = record
  { _â‚€_ =       h    âˆ˜_
  ; _â‚_ = reflâ‚ h â‚ âŸ©âˆ˜âŸ¨_
  }

ğ“±ğ“¸ğ“¶â½_,-â¾ : âˆ€ A â†’ ğ“’ âŸ¶ ğ“¢ğ“®ğ“½
ğ“±ğ“¸ğ“¶â½ A ,-â¾ = record
  { _â‚€_ = Î» - â†’ ğ’‰ğ’ğ’ ğ“’ A -
  ; _â‚_ = ğ“±ğ“¸ğ“¶â½ A ,_â¾
  ; _â‚‚_ = Î» hâ‚âˆ¼hâ‚‚ gâ‚âˆ¼gâ‚‚ â†’ hâ‚âˆ¼hâ‚‚ âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚
  ; resp-âˆ˜â‚€ = Î» {B}
                {gâ‚ gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B}
                gâ‚âˆ¼gâ‚‚ â†’ begin
    id âˆ˜ gâ‚  â†“âŸ¨ âˆ˜-unitË¡ ğ“’ âŸ©
    gâ‚       â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
    gâ‚‚       âˆ
  ; resp-âˆ˜â‚‚ = Î» {B Bâ€² Bâ€³}
                {h     : ğ“’ âˆ£ B  âŸ¶ Bâ€²}
                {hâ€²    : ğ“’ âˆ£ Bâ€² âŸ¶ Bâ€³}
                {gâ‚ gâ‚‚ : ğ“’ âˆ£ A  âŸ¶ B }
                gâ‚âˆ¼gâ‚‚ â†’ begin
    (hâ€² âˆ˜ h) âˆ˜ gâ‚  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
    (hâ€² âˆ˜ h) âˆ˜ gâ‚‚  â†“âŸ¨ âˆ˜-assoc ğ“’ âŸ©
    hâ€² âˆ˜ (h âˆ˜ gâ‚‚)  âˆ
  }

ğ“±â½_â¾â° = ğ“±ğ“¸ğ“¶â½_,-â¾

ğ“±ğ“¸ğ“¶â‚-,-â‚ : ğ“’ áµ’áµ– Ã— ğ“’ âŸ¶ ğ“¢ğ“®ğ“½
ğ“±ğ“¸ğ“¶â‚-,-â‚ = record
  { _â‚€_ = Î» { (A , B) â†’ ğ’‰ğ’ğ’ ğ“’ A B }
  ; _â‚_ = Î» { {A , B} {Aâ€² , Bâ€²} (f , h) â†’ record
    { _â‚€_ = Î» g     â†’       h    âˆ˜  g      âˆ˜        f
    ; _â‚_ = Î» gâ‚âˆ¼gâ‚‚ â†’ reflâ‚ h â‚ âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©âˆ˜âŸ¨ reflâ‚ f â‚
    } }
  ; _â‚‚_ = Î» { (fâ‚âˆ¼fâ‚‚ , hâ‚âˆ¼hâ‚‚) gâ‚âˆ¼gâ‚‚ â†’ hâ‚âˆ¼hâ‚‚ âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©âˆ˜âŸ¨ fâ‚âˆ¼fâ‚‚ }
  ; resp-âˆ˜â‚€ = Î» { {A , B} {gâ‚} {gâ‚‚} gâ‚âˆ¼gâ‚‚ â†’ begin
    id âˆ˜ gâ‚ âˆ˜ id  â†“âŸ¨ âˆ˜-unitË¡ ğ“’ âŸ©
    gâ‚ âˆ˜ id       â†“âŸ¨ âˆ˜-unitÊ³ ğ“’ âŸ©
    gâ‚            â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
    gâ‚‚            âˆ }
  ; resp-âˆ˜â‚‚ = Î» { {A , B} {Aâ€² , Bâ€²} {Aâ€³ , Bâ€³}
                  {f  , h } -- f     : ğ“’ áµ’áµ– âˆ£ A  âŸ¶ Aâ€²
                            -- h     : ğ“’    âˆ£ B  âŸ¶ Bâ€²
                  {fâ€² , hâ€²} -- fâ€²    : ğ“’ áµ’áµ– âˆ£ Aâ€² âŸ¶ Aâ€³
                            -- hâ€²    : ğ“’    âˆ£ Bâ€² âŸ¶ Bâ€³
                  {gâ‚} {gâ‚‚} -- gâ‚ gâ‚‚ : ğ“’    âˆ£ A  âŸ¶ B
                  gâ‚âˆ¼gâ‚‚ â†’ begin
    (hâ€² âˆ˜ h) âˆ˜ gâ‚ âˆ˜ (fâ€² âˆ˜Ì… f)  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©âˆ˜âŸ¨ refl âŸ©
    (hâ€² âˆ˜ h) âˆ˜ gâ‚‚ âˆ˜ (f âˆ˜ fâ€²)  â†“âŸ¨ âˆ˜-assoc ğ“’ âŸ©
    hâ€² âˆ˜ h âˆ˜ gâ‚‚ âˆ˜ f âˆ˜ fâ€²      â†‘âŸ¨ refl âŸ©âˆ˜âŸ¨ âˆ˜-assoc ğ“’ âŸ©
    hâ€² âˆ˜ (h âˆ˜ gâ‚‚) âˆ˜ f âˆ˜ fâ€²    â†‘âŸ¨ refl âŸ©âˆ˜âŸ¨ âˆ˜-assoc ğ“’ âŸ©
    hâ€² âˆ˜ ((h âˆ˜ gâ‚‚) âˆ˜ f) âˆ˜ fâ€²  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ âˆ˜-assoc ğ“’ âŸ©âˆ˜âŸ¨ refl âŸ©
    hâ€² âˆ˜ (h âˆ˜ gâ‚‚ âˆ˜ f) âˆ˜ fâ€²    âˆ }
  }

ğ“±â‚_â‚â‚ : âˆ€ {B Bâ€²}
  â†’ ğ“’   âˆ£    B    âŸ¶    Bâ€²
  â†’ ğ“ğ“ªğ“½ âˆ£ ğ“±â‚ B â‚â‚€ âŸ¶ ğ“±â‚ Bâ€² â‚â‚€
ğ“±â‚_â‚â‚ {B} {Bâ€²} h = record
  { _â‚_â‚    = Î» A â†’ ğ“±ğ“¸ğ“¶â½ A , h â¾
  ; natural = Î» {A Aâ€²}
                {f     : ğ“’ áµ’áµ– âˆ£ A âŸ¶ Aâ€²}
                {gâ‚ gâ‚‚ : ğ“’    âˆ£ A âŸ¶ B }
                gâ‚âˆ¼gâ‚‚ â†’ begin
    h âˆ˜ (gâ‚ âˆ˜ f)  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©âˆ˜âŸ¨ refl âŸ©
    h âˆ˜ (gâ‚‚ âˆ˜ f)  â†‘âŸ¨ âˆ˜-assoc ğ“’ âŸ©
    (h âˆ˜ gâ‚‚) âˆ˜ f  âˆ
  }

ğ“±â½_â¾Â¹ : âˆ€ {A Aâ€²}
  â†’ ğ“’ áµ’áµ– âˆ£    A    âŸ¶    Aâ€²
  â†’ ğ“ğ“ªğ“½  âˆ£ ğ“±â½ A â¾â° âŸ¶ ğ“±â½ Aâ€² â¾â°
ğ“±â½_â¾Â¹ {A} {Aâ€²} f = record
  { _â‚_â‚    = Î» B â†’ ğ“±ğ“¸ğ“¶â‚ f , B â‚
  ; natural = Î» {B Bâ€²}
                {h     : ğ“’ âˆ£ B âŸ¶ Bâ€²}
                {gâ‚ gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B }
                gâ‚âˆ¼gâ‚‚ â†’ begin
    (h âˆ˜ gâ‚) âˆ˜ f  â†“âŸ¨ (refl âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚) âŸ©âˆ˜âŸ¨ refl âŸ©
    (h âˆ˜ gâ‚‚) âˆ˜ f  â†“âŸ¨ âˆ˜-assoc ğ“’ âŸ©
    h âˆ˜ (gâ‚‚ âˆ˜ f)  âˆ
  }

ğ“±â‚‹ : ğ“’ âŸ¶ [ ğ“’ áµ’áµ– , ğ“¢ğ“®ğ“½ ]
ğ“±â‚‹ = record
  { _â‚€_ = ğ“±â‚_â‚â‚€
  ; _â‚_ = ğ“±â‚_â‚â‚
  ; _â‚‚_ = Î» hâ‚âˆ¼hâ‚‚ gâ‚âˆ¼gâ‚‚ â†’ hâ‚âˆ¼hâ‚‚ âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚
  ; resp-âˆ˜â‚€ = Î» {B A}
                {gâ‚ gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B}
                gâ‚âˆ¼gâ‚‚ â†’ begin
    id âˆ˜ gâ‚  â†“âŸ¨ âˆ˜-unitË¡ ğ“’ âŸ©
    gâ‚       â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
    gâ‚‚       âˆ
  ; resp-âˆ˜â‚‚ = Î» {B Bâ€² Bâ€³}
                {h     : ğ“’ âˆ£ B  âŸ¶ Bâ€²}
                {hâ€²    : ğ“’ âˆ£ Bâ€² âŸ¶ Bâ€³}
                {A}
                {gâ‚ gâ‚‚ : ğ“’ âˆ£ A  âŸ¶ B }
                gâ‚âˆ¼gâ‚‚ â†’ begin
    (hâ€² âˆ˜ h) âˆ˜ gâ‚  â†“âŸ¨ refl âŸ©âˆ˜âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
    (hâ€² âˆ˜ h) âˆ˜ gâ‚‚  â†“âŸ¨ âˆ˜-assoc ğ“’ âŸ©
    hâ€² âˆ˜ (h âˆ˜ gâ‚‚)  âˆ
  }

ğ“±â» : ğ“’ áµ’áµ– âŸ¶ [ ğ“’ , ğ“¢ğ“®ğ“½ ]
ğ“±â» = record
  { _â‚€_ = ğ“±â½_â¾â°
  ; _â‚_ = ğ“±â½_â¾Â¹
  ; _â‚‚_ = Î» fâ‚âˆ¼fâ‚‚ gâ‚âˆ¼gâ‚‚ â†’ gâ‚âˆ¼gâ‚‚ âŸ©âˆ˜âŸ¨ fâ‚âˆ¼fâ‚‚
  ; resp-âˆ˜â‚€ = Î» {A B}
                {gâ‚ gâ‚‚ : ğ“’ âˆ£ A âŸ¶ B}
                gâ‚âˆ¼gâ‚‚ â†’ begin
    gâ‚ âˆ˜ id  â†“âŸ¨ âˆ˜-unitÊ³ ğ“’ âŸ©
    gâ‚       â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©
    gâ‚‚       âˆ
  ; resp-âˆ˜â‚‚ = Î» {A Aâ€² Aâ€³}
                {f     : ğ“’ áµ’áµ– âˆ£ A  âŸ¶ Aâ€²}
                {fâ€²    : ğ“’ áµ’áµ– âˆ£ Aâ€² âŸ¶ Aâ€³}
                {B}
                {gâ‚ gâ‚‚ : ğ“’    âˆ£ A  âŸ¶ B }
                gâ‚âˆ¼gâ‚‚ â†’ begin
    gâ‚ âˆ˜ (fâ€² âˆ˜Ì… f)  â†“âŸ¨ gâ‚âˆ¼gâ‚‚ âŸ©âˆ˜âŸ¨ refl âŸ©
    gâ‚‚ âˆ˜ (f âˆ˜ fâ€²)  â†‘âŸ¨ âˆ˜-assoc ğ“’ âŸ©
    (gâ‚‚ âˆ˜ f) âˆ˜ fâ€²  âˆ
  }
